<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML VERSION="2.0">
<HEAD>
   <TITLE>MB-System Unix Manual Page: mbbackangleold</TITLE>
<!-- WEBMAGIC VERSION NUMBER="2.0.2" -->
<!-- WEBMAGIC TRANSLATION NAME="ServerRoot" SRC="/var/www/htdocs/" DST="/" -->
<!-- WEBMAGIC TRANSLATION NAME="ProjectRoot" SRC="./" DST="" -->
</HEAD>
<BODY TEXT="#000000" BGCOLOR="#FFFFFF" LINK="#336699" VLINK="#997040" ALINK="#CC9900">
<BODY>
<CENTER><H3><U>MB-System Unix Manual Page</U></H3></CENTER>
<PRE>
<H1>mbbackangleold</H1>
Section: MB-System 5.0 (l)<BR>Updated: 18 July 2002<BR><A HREF="#index">Index</A>
<HR>

<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

<B>mbbackangleold</B> - Old tool to generate a table 
of the average amplitude or 
sidescan values in swath sonar data as a function of 
the grazing angle with the seafloor.
<P>
<A NAME="lbAC">&nbsp;</A>
<H2>VERSION</H2>

Version 5.0
<P>
<A NAME="lbAD">&nbsp;</A>
<H2>SYNOPSIS</H2>

<B>mbbackangleold</B> [<B>-A</B><I>kind</I> <B>-B</B><I>yr/mo/da/hr/mn/sc 
</I><B>-C</B> <B>-E</B><I>yr/mo/da/hr/mn/sc 
</I><B>-F</B><I>format</I> <B>-I</B><I>file</I>  <B>-N</B><I>nangle/anglemax</I>
<B>-R</B><I>west/east/south/north</I> <B>-S</B><I>speed 
</I><B>-Z</B><I>depth</I> <B>-V -H</B>]
<P>
<A NAME="lbAE">&nbsp;</A>
<H2>DESCRIPTION</H2>

The program <B>mbbackangleold</B> reads a swath sonar data file 
containing beam amplitude and/or sidescan data and generates a table
of the average amplitude or sidescan values as a function of
the grazing angle with the seafloor.This program replicates the
functionality of the <B>mbbackangle</B> program included
in <B>MB-System</B> version 4 distributions. 
The current version of <B>mbbackangle</B>
generates a series of average sidescan tables
in an &quot;amplitude vs grazing angle&quot; or &quot;.aga&quot; file that can
be used by <B>mbprocess</B>. See the <B>mbbackangle</B> and <B>mbprocess</B>
manual pages for details.
<P>
The average amplitude or sidescan table generated by 
<B>mbbackangleold</B> can be used
by the program <B>mbanglecorrect</B> to correct the amplitude or
sidescan data for the variation with grazing angle. No assumption
is made about the nature of the data or the sonar used to
collect it. If bathymetry is
not available, the seafloor is assumed to be flat with a depth
specified by the <B>-Z</B> option. The takeoff
angle for each beam or pixel arrival is projected to the seafloor;
no raytracing is done. The user specifies the angular width 
of the swath considered and the number of angular bins in that
swath; the average amplitude or sidescan value within each bin
form the output data. The results are dumped to stdout.
<P>
<A NAME="lbAF">&nbsp;</A>
<H2>AUTHORSHIP</H2>

David W. Caress (<A HREF="mailto:caress@mbari.org">caress@mbari.org</A>)
<BR>

<BR>&nbsp;&nbsp;Monterey&nbsp;Bay&nbsp;Aquarium&nbsp;Research&nbsp;Institute
<BR>

Dale N. Chayes (<A HREF="mailto:dale@ldeo.columbia.edu">dale@ldeo.columbia.edu</A>)
<BR>

<BR>&nbsp;&nbsp;Lamont-Doherty&nbsp;Earth&nbsp;Observatory
<P>
<A NAME="lbAG">&nbsp;</A>
<H2>OPTIONS</H2>

<DL COMPACT>
<DT><B>-A</B>

<DD>
<I>kind</I>
<BR>

Determines whether beam amplitude (<I>kind</I> = 1) 
or sidescan (<I>kind</I> = 2) data will be processed. 
Default: <I>kind</I> = 2.
<DT><B>-B</B>

<DD>
<I>yr/mo/da/hr/mn/sc</I>
<BR>

This option sets the starting time for data allowed in the input data.
The <B>-E</B> option sets the ending time for data. If the 
starting time is before the ending time, then any data
with a time stamp before the starting time or after the
ending time is ignored. If instead the starting time is
after the ending time, then any data between the ending
and starting time will be ignored. This scheme allows time
windowing both inside and outside a specified interval.
Default: <I>yr/mo/da/hr/mn/sc</I> = 1962/2/21/10/30/0.
<DT><B>-C</B>

<DD>
Normally, <B>mbbackangleold</B> produces a table of amplitude vs
grazing angle values which is symmetric about the vertical
(zero angle) axis. If <B>-C</B> is specified, the amplitude
vs grazing angle function will not be forced to be symmetric.
<DT><B>-E</B>

<DD>
<I>yr/mo/da/hr/mn/sc</I>
<BR>

This option sets the ending time for data allowed in the input data.
The <B>-B</B> option sets the starting time for data. If the 
starting time is before the ending time, then any data
with a time stamp before the starting time or after the
ending time is ignored. If instead the starting time is
after the ending time, then any data between the ending
and starting time will be ignored. This scheme allows time
windowing both inside and outside a specified interval.
Default: <I>yr/mo/da/hr/mn/sc</I> = 2062/2/21/10/30/0.
<DT><B>-F</B>

<DD>
<I>format</I>
<BR>

Sets the data format used if the input is read from stdin
or from a file. If <I>format</I> &lt; 0, then the input file specified
with the <B>-I</B> option will actually contain a list of input swath sonar
data files. This program uses the <B>MBIO</B> library 
and will read or write any swath sonar
format supported by <B>MBIO</B>. A list of the swath sonar data formats
currently supported by <B>MBIO</B> and their identifier values
is given in the <B>MBIO</B> manual page. Default: <I>format</I> = 11.
<DT><B>-H</B>

<DD>
This &quot;help&quot; flag causes the program to print out a description
of its operation and then exit immediately.
<DT><B>-I</B>

<DD>
<I>filename</I>
<BR>

Sets the input filename. If <I>format</I> &gt; 0 (set with the 
<B>-F</B> option) then the swath sonar data contained in <I>infile</I> 
is read and processed. If <I>format</I> &lt; 0, then <I>infile</I>
is assumed to be an ascii file containing a list of the input swath sonar
data files to be processed and their formats.  The program will read 
the data in each one of these files.
In the <I>infile</I> file, each
data file should be followed by a data format identifier, e.g.:
<BR>&nbsp;<TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TT>datafile1&nbsp;11<BR>
<BR>&nbsp;<TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TT>datafile2&nbsp;24<BR>
<BR>

This program uses the <B>MBIO</B> library and will read or write any swath sonar
format supported by <B>MBIO</B>. A list of the swath sonar data formats
currently supported by <B>MBIO</B> and their identifier values
is given in the <B>MBIO</B> manual page. Default: <I>infile</I> = &quot;stdin&quot;.
<DT><B>-N</B>

<DD>
<I>nangle/angle</I>
<BR>

The amplitude vs grazing angle table is calculated by binning the
amplitude values according to their grazing angles and averaging
the amplitudes within each bin. This option sets the number of
grazing angle bins (<I>nangle</I>) and the maximum angle considered
(<I>angle</I>). The grazing angle function will be defined at
<I>nangle</I> points spaced equally from -<I>angle</I> to 
+<I>angle</I>. The <I>nangle</I> value should be an odd integer
so that the middle bin is centered on the angle 0.0.
Default: <I>nangle</I> = 161, <I>angle</I> = 80.0.
<DT><B>-R</B>

<DD>
<I>west/east/south/north</I>
<BR>

Sets the longitude and latitude bounds within which swath sonar 
data will be read. Only the data which lies within these bounds will
be copied. 
Default: <I>west</I>=-360, east<I>=360</I>, <I>south</I>=-90, <I>north</I>=90.
<DT><B>-S</B>

<DD>
<I>speed</I>
<BR>

Sets the minimum speed in km/hr (5.5 kts ~ 10 km/hr) allowed in 
the input data; pings associated with a smaller ship speed will not be
copied. Default: <I>speed</I> = 0.
<DT><B>-V</B>

<DD>
Normally, <B>mbbackangleold</B> works &quot;silently&quot; without outputting
anything to the stderr stream.  If the
<B>-V</B> flag is given, then <B>mbmask</B> works in a &quot;verbose&quot; mode and
outputs the program version being used and all error status messages.
<DT><B>-Z</B>

<DD>
<I>depth</I>
<BR>

This option specifies a default depth value in meters to be
used whenever bathymetry values are unavailable. A flat seafloor
(zero slope) will be assumed wherever the default depth needs
to be used (e.g. data files with sidescan but no bathymetry, or
the outer parts of swaths where the sidescan may extend further
than the bathymetry). If this option is not specified, any
amplitude or sidescan values without associated bathymetry
information will not be used in calculating the amplitude
vs grazing angle table.
<P>
</DL>
<A NAME="lbAH">&nbsp;</A>
<H2>EXAMPLE</H2>

Suppose one has a SeaBeam 2100 data file called test.mb41
which contains bathymetry (121 beams in a 120 degree swath), 
beam amplitude (121 beams coincident with bathymetry),
and sidescan data (2000 pixels, roughly a 150 degree swath).
Plots of the raw sidescan are dominated by the high amplitude
specular region in the center of the swath and the gradual
fall-off of amplitudes in the outer swath. In order to obtain
a correction function which can be used by <B>mbanglecorrect</B>
to &quot;flatten out&quot; the sidescan values so that seafloor features
are more evident, the user can run <B>mbbackangleold</B> as follows:
<BR>&nbsp;<TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TT>mbbackangleold&nbsp;-F41&nbsp;-Itest.mb41&nbsp;-A2&nbsp;-N161/80<BR>
<BR>

The output comes to stdout as a set of <I>nangle</I> (161)
ACII lines each containing one pair of angle and average
amplitude values:
<BR>&nbsp;-64.000000&nbsp;727.933366
<BR>&nbsp;-63.000000&nbsp;765.391874
<BR>&nbsp;-62.000000&nbsp;762.552656
<BR>&nbsp;-61.000000&nbsp;711.655808
<BR>&nbsp;-60.000000&nbsp;631.966401
<BR>&nbsp;-59.000000&nbsp;563.588467
<BR>&nbsp;-58.000000&nbsp;555.110137
<BR>&nbsp;-57.000000&nbsp;540.660712
<BR>&nbsp;-56.000000&nbsp;605.508072
<BR>&nbsp;-55.000000&nbsp;658.763692
<BR>&nbsp;-54.000000&nbsp;726.006440
<BR>&nbsp;-53.000000&nbsp;851.389106
<BR>&nbsp;-52.000000&nbsp;911.463876
<BR>&nbsp;-51.000000&nbsp;927.908720
<BR>&nbsp;-50.000000&nbsp;971.749079
<BR>&nbsp;-49.000000&nbsp;1041.232836
<BR>&nbsp;-48.000000&nbsp;1033.725516
<BR>&nbsp;-47.000000&nbsp;1084.941435
<BR>&nbsp;-46.000000&nbsp;1173.430224
<BR>&nbsp;-45.000000&nbsp;1219.655876
<BR>&nbsp;-44.000000&nbsp;1263.997789
<BR>&nbsp;-43.000000&nbsp;1287.571182
<BR>&nbsp;-42.000000&nbsp;1248.881823
<BR>&nbsp;-41.000000&nbsp;1321.806504
<BR>&nbsp;-40.000000&nbsp;1416.306163
<BR>&nbsp;-39.000000&nbsp;1468.342740
<BR>&nbsp;-38.000000&nbsp;1511.206454
<BR>&nbsp;-37.000000&nbsp;1619.645511
<BR>&nbsp;-36.000000&nbsp;1601.959117
<BR>&nbsp;-35.000000&nbsp;1639.856949
<BR>&nbsp;-34.000000&nbsp;1820.206447
<BR>&nbsp;-33.000000&nbsp;1899.774419
<BR>&nbsp;-32.000000&nbsp;2039.100963
<BR>&nbsp;-31.000000&nbsp;2188.549047
<BR>&nbsp;-30.000000&nbsp;2198.595859
<BR>&nbsp;-29.000000&nbsp;2319.472727
<BR>&nbsp;-28.000000&nbsp;2542.527061
<BR>&nbsp;-27.000000&nbsp;2631.109418
<BR>&nbsp;-26.000000&nbsp;2522.161503
<BR>&nbsp;-25.000000&nbsp;2614.772907
<BR>&nbsp;-24.000000&nbsp;2861.066208
<BR>&nbsp;-23.000000&nbsp;2991.539474
<BR>&nbsp;-22.000000&nbsp;3122.064477
<BR>&nbsp;-21.000000&nbsp;3043.202609
<BR>&nbsp;-20.000000&nbsp;3147.861928
<BR>&nbsp;-19.000000&nbsp;3314.436011
<BR>&nbsp;-18.000000&nbsp;3507.669565
<BR>&nbsp;-17.000000&nbsp;3745.632558
<BR>&nbsp;-16.000000&nbsp;4052.080873
<BR>&nbsp;-15.000000&nbsp;4064.052135
<BR>&nbsp;-14.000000&nbsp;4486.166369
<BR>&nbsp;-13.000000&nbsp;4816.169209
<BR>&nbsp;-12.000000&nbsp;5318.674783
<BR>&nbsp;-11.000000&nbsp;5619.060352
<BR>&nbsp;-10.000000&nbsp;5837.487238
<BR>&nbsp;-9.000000&nbsp;6885.289048
<BR>&nbsp;-8.000000&nbsp;7426.885985
<BR>&nbsp;-7.000000&nbsp;9265.994437
<BR>&nbsp;-6.000000&nbsp;11172.203110
<BR>&nbsp;-5.000000&nbsp;12973.700872
<BR>&nbsp;-4.000000&nbsp;14764.825333
<BR>&nbsp;-3.000000&nbsp;15236.592260
<BR>&nbsp;-2.000000&nbsp;15315.271640
<BR>&nbsp;-1.000000&nbsp;17197.422379
<BR>&nbsp;0.000000&nbsp;20346.039283
<BR>&nbsp;1.000000&nbsp;17197.422379
<BR>&nbsp;2.000000&nbsp;15315.271640
<BR>&nbsp;3.000000&nbsp;15236.592260
<BR>&nbsp;4.000000&nbsp;14764.825333
<BR>&nbsp;5.000000&nbsp;12973.700872
<BR>&nbsp;6.000000&nbsp;11172.203110
<BR>&nbsp;7.000000&nbsp;9265.994437
<BR>&nbsp;8.000000&nbsp;7426.885985
<BR>&nbsp;9.000000&nbsp;6885.289048
<BR>&nbsp;10.000000&nbsp;5837.487238
<BR>&nbsp;11.000000&nbsp;5619.060352
<BR>&nbsp;12.000000&nbsp;5318.674783
<BR>&nbsp;13.000000&nbsp;4816.169209
<BR>&nbsp;14.000000&nbsp;4486.166369
<BR>&nbsp;15.000000&nbsp;4064.052135
<BR>&nbsp;16.000000&nbsp;4052.080873
<BR>&nbsp;17.000000&nbsp;3745.632558
<BR>&nbsp;18.000000&nbsp;3507.669565
<BR>&nbsp;19.000000&nbsp;3314.436011
<BR>&nbsp;20.000000&nbsp;3147.861928
<BR>&nbsp;21.000000&nbsp;3043.202609
<BR>&nbsp;22.000000&nbsp;3122.064477
<BR>&nbsp;23.000000&nbsp;2991.539474
<BR>&nbsp;24.000000&nbsp;2861.066208
<BR>&nbsp;25.000000&nbsp;2614.772907
<BR>&nbsp;26.000000&nbsp;2522.161503
<BR>&nbsp;27.000000&nbsp;2631.109418
<BR>&nbsp;28.000000&nbsp;2542.527061
<BR>&nbsp;29.000000&nbsp;2319.472727
<BR>&nbsp;30.000000&nbsp;2198.595859
<BR>&nbsp;31.000000&nbsp;2188.549047
<BR>&nbsp;32.000000&nbsp;2039.100963
<BR>&nbsp;33.000000&nbsp;1899.774419
<BR>&nbsp;34.000000&nbsp;1820.206447
<BR>&nbsp;35.000000&nbsp;1639.856949
<BR>&nbsp;36.000000&nbsp;1601.959117
<BR>&nbsp;37.000000&nbsp;1619.645511
<BR>&nbsp;38.000000&nbsp;1511.206454
<BR>&nbsp;39.000000&nbsp;1468.342740
<BR>&nbsp;40.000000&nbsp;1416.306163
<BR>&nbsp;41.000000&nbsp;1321.806504
<BR>&nbsp;42.000000&nbsp;1248.881823
<BR>&nbsp;43.000000&nbsp;1287.571182
<BR>&nbsp;44.000000&nbsp;1263.997789
<BR>&nbsp;45.000000&nbsp;1219.655876
<BR>&nbsp;46.000000&nbsp;1173.430224
<BR>&nbsp;47.000000&nbsp;1084.941435
<BR>&nbsp;48.000000&nbsp;1033.725516
<BR>&nbsp;49.000000&nbsp;1041.232836
<BR>&nbsp;50.000000&nbsp;971.749079
<BR>&nbsp;51.000000&nbsp;927.908720
<BR>&nbsp;52.000000&nbsp;911.463876
<BR>&nbsp;53.000000&nbsp;851.389106
<BR>&nbsp;54.000000&nbsp;726.006440
<BR>&nbsp;55.000000&nbsp;658.763692
<BR>&nbsp;56.000000&nbsp;605.508072
<BR>&nbsp;57.000000&nbsp;540.660712
<BR>&nbsp;58.000000&nbsp;555.110137
<BR>&nbsp;59.000000&nbsp;563.588467
<BR>&nbsp;60.000000&nbsp;631.966401
<BR>&nbsp;61.000000&nbsp;711.655808
<BR>&nbsp;62.000000&nbsp;762.552656
<BR>&nbsp;63.000000&nbsp;765.391874
<BR>&nbsp;64.000000&nbsp;727.933366
<BR>

The output data can be directed to a correction file to be used
as input for the program <B>mbanglecorrect</B>.
<P>
<A NAME="lbAI">&nbsp;</A>
<H2>SEE ALSO</H2>

<B><A HREF="mbsystem.html">mbsystem</A></B>(l), <B><A HREF="mbanglecorrect.html">mbanglecorrect</A></B>(l), <B><A HREF="mbfilter.html">mbfilter</A></B>(l)
<P>
<A NAME="lbAJ">&nbsp;</A>
<H2>BUGS</H2>

None worth bragging about.
<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">VERSION</A><DD>
<DT><A HREF="#lbAD">SYNOPSIS</A><DD>
<DT><A HREF="#lbAE">DESCRIPTION</A><DD>
<DT><A HREF="#lbAF">AUTHORSHIP</A><DD>
<DT><A HREF="#lbAG">OPTIONS</A><DD>
<DT><A HREF="#lbAH">EXAMPLE</A><DD>
<DT><A HREF="#lbAI">SEE ALSO</A><DD>
<DT><A HREF="#lbAJ">BUGS</A><DD>
</DL>
<HR>
</PRE>

<CENTER><P><BR>
Last Updated: 18 July 2002</P></CENTER>

<HR>
<P><A HREF="mbsystem_man_list.html">Return to list of MB-System manual pages...</A></P>
<P><A HREF="mbsystem_home.html"><IMG SRC="mbsystem_logo_small.gif" BORDER=0 HEIGHT=55 WIDTH=158 ALIGN=BOTTOM></A><A HREF="mbsystem_home.html">Back
to MB-System Home Page...</A></P>

</BODY>
</HTML>
