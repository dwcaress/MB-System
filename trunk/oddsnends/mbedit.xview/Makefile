#     The MB-system:	Makefile  5/25/93
#	$Id: Makefile,v 4.1 1994-10-21 12:01:43 caress Exp $
#
#     Copyright (c) 1993 by 
#     D. W. Caress (caress@lamont.ldgo.columbia.edu)
#     and D. N. Chayes (dale@lamont.ldgo.columbia.edu)
#     Lamont-Doherty Earth Observatory
#     Palisades, NY  10964
#
#     See README file for copying and redistribution conditions.
#
# Makefile for MB-system in the src directory
# Author:	D. W. Caress
# Date:		January 21, 1993
# 
# $Log: not supported by cvs2svn $
# Revision 4.0  1994/03/05  23:54:35  caress
# First cut at version 4.0
#
# Revision 4.0  1994/03/05  22:47:41  caress
# First cut at new version.
#
# Revision 1.4  1994/03/01  00:22:07  caress
# First cut at new version.
#
# Revision 1.3  1993/08/30  19:02:30  caress
# Current version.
#
# Revision 1.2  1993/05/25  19:59:52  caress
# Added chmod command after cp command so the man page can
# be overwritten by later makes.
#
# Revision 1.1  1993/05/25  19:01:54  caress
# Initial revision
#
#
# This file was generated by `gxv' from `mbedit.G'.

# Parameters.

PROGRAM = mbedit
EXEC = ../../bin/$(PROGRAM)
MANPAGE = ../../man/man1/$(PROGRAM).1
SOURCES.c = mbedit.c xgraphics.c
SOURCES.h = \
	../../include/mb_io.h \
	../../include/mb_format.h \
	../../include/mb_status.h
SOURCES.G = mbedit.G
STUBS.G = mbedit.G

# Derived parameters.

SOURCES = \
	$(SOURCES.G) \
	$(SOURCES.h) \
	$(SOURCES.l) \
	$(SOURCES.y) \
	$(SOURCES.cps) \
	$(SOURCES.c)

TARGETS.c = \
	$(SOURCES.G:%.G=%_ui.c) \
	$(STUBS.G:%.G=%_stubs.c)

TARGETS.h = \
	$(SOURCES.G:%.G=%_ui.h) \
	$(SOURCES.l:%.l=%.h) \
	$(SOURCES.y:%.y=%.h) \
	$(SOURCES.cps:%.cps=%.h)

TARGETS.other = \
	$(SOURCES.G:%.G=%.info)

TARGETS = \
	$(TARGETS.other) \
	$(TARGETS.h) \
	$(TARGETS.c)

OBJECTS = \
	$(SOURCES.c:%.c=%.o) \
	$(TARGETS.c:%.c=%.o)

# Compiler flags.

CFLAGS += -g 
CPPFLAGS += -I$(GUIDEHOME)/include -I$(OPENWINHOME)/include -DMAIN
LDFLAGS += -L$(GUIDEHOME)/lib -L$(OPENWINHOME)/lib -L../../lib
LDLIBS += -lguidexv -lguide -lxview -lolgx -lX11 -lmbio -lm

# Standard targets.

#all:	 $(TARGETS.other) $(PROGRAM) $(MANPAGE)
all:	 $(TARGETS.other) $(PROGRAM) $(EXEC) $(MANPAGE)
objects: $(SOURCES.c) $(TARGETS.c) $(TARGETS.h) $(OBJECTS)
sources: $(SOURCES)
targets: $(SOURCES) $(TARGETS)

$(EXEC): $(PROGRAM)
	cp $(PROGRAM) $(EXEC)

$(MANPAGE): $(PROGRAM).1
	cp $(PROGRAM).1 $(MANPAGE)
	chmod 664 $(MANPAGE)

$(PROGRAM): $(SOURCES.c) $(TARGETS.c) $(TARGETS.h) $(OBJECTS)
	$(LINK.c) -Bstatic -o $@ $(OBJECTS) $(LDLIBS)

# Targets to be used by Saber-C.

saber_src:
	#load $(CFLAGS) $(CPPFLAGS) $(LDFLAGS) $(TARGET_ARCH) \
		$(SOURCES.c) $(TARGETS.c) $(LDLIBS)

saber_obj:
	#load $(CFLAGS) $(CPPFLAGS) $(LDFLAGS) $(TARGET_ARCH) $(OBJECTS) $(LDLIBS)

clean:
	$(RM) *.BAK *.delta core *%

#clean:
#	$(RM) $(SOURCES.G:%.G=%_ui.c) $(TARGETS.other) $(TARGETS.h) $(OBJECTS) *.BAK *.delta core

%_ui.c: %.G
	gxv $*

%_ui.h: %_ui.c
	@touch $@

%_stubs.c: %_ui.c
	@touch $@

%.info: %_ui.c
	@touch $@
